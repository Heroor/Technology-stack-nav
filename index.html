<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="Hello Nav" content="前端开发导航">
    <meta name="keywords" content="前端导航,Hello Nav">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0" />
    <link rel="shortcut icon" href="./favicon.ico">
    <link rel="manifest" href="./manifest.json">
    <title>Hello Nav!</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        list-style: none;
        text-decoration: none;
      }
      h1 {
        height: 0;
        line-height: 0;
        width: 0;
        text-indent: -99999px;
      }
      body {
        background: #f7f7f7;
        font-size: 14px;
        font-family: 'microsoft yahei';
        box-shadow:inset 0 15px 15px -15px rgba(0,0,0,.4)
      }
      #app {
        padding: 70px 0;
        text-align: center;
      }
      .search-input {
        outline: none;
        height: 30px;
        line-height: 30px;
        width: 60px;
        padding: 0 15px;
        margin: 0 12vw 30px;
        border: 1px solid #e4e4e4;
        border-radius: 100px;
        color: #999;
        font-size: 14px;
        transition: .2s;
      }
      .search-input:hover {
        width: 60px;
        border-color: rgba(4, 170, 255, 0.2);
        box-shadow: 0 0 10px rgba(4, 170, 255, 0.2);
      }
      .search-input:focus {
        width: 210px;
        transition: .5s;
        border-color: rgba(4, 170, 255, 0.4);
        box-shadow: 0 0 14px rgba(4, 170, 255, 0.3);
      }
      .contain {
        display: grid;
        justify-content: center;
        grid-template-columns: repeat(auto-fill, 130px);
        padding: 0 70px;
      }
      .cell {
        text-align: center;
        display: grid;
        grid-template: 15px 1fr 15px / 15px 1fr 15px;
        transform-origin: bottom;
      }
      .cell:hover {
        animation: 2.5s 2s rock infinite;
      }
      .cell:hover a {
        transform: translateY(-5px);
      }
      .cell a {
        display: grid;
        grid-area: 2 / 2;
        grid-template: 70px 28px / 100%;
        border-radius: 6px;
        transition: .382s;
      }
      .cell a:hover {
        transition: 0s;
        box-shadow: 0 0 30px rgba(0, 0, 0, .08);
        background: #fff;
      }
      .cell .img-box {
        display: flex;
        justify-content: center;
        align-items: center;
      }
      .cell img {
        width: 50px;
        border-radius: 4px;
      }
      .cell .title {
        font-size: 14px;
        color: #757575;
      }
      .err-message {
        line-height: 30px;
        text-align: center;
        padding-top: 200px;
        font-size: 20px;
        color: gray;
      }
      @keyframes rock {
        75% {
          transform: rotate(0deg);
        }
        80% {
          transform: rotate(-4deg);
        }
        85% {
          transform: rotate(3deg);
        }
        90% {
          transform: rotate(-2deg);
        }
        95% {
          transform: rotate(1deg);
        }
      }
    </style>
  </head>
  <body>
    <h1>Hello Nav</h1>
    <main id="app"></main>
  </body>
    <script>
      // navigator.serviceWorker && navigator.serviceWorker.register('./sw.js').then(reg => {
      //   console.log('sw is registed', reg)
      // }).catch(console.error)
    </script>
    <script src="https://cdn.bootcss.com/react/15.4.2/react.min.js"></script>
    <script src="https://cdn.bootcss.com/react/15.4.2/react-dom.min.js"></script>
    <script src="https://cdn.bootcss.com/babel-core/5.8.38/browser.min.js"></script>
    <script src="./config.js"></script>
    <script type="text/babel">
      void (function (library) {
        const WithError = (Component, text) => ({isError, ...props}) => (
          isError ?
          <p className="err-message">{text}</p> :
          <Component {...props} />
        )

        class App extends React.Component {
          constructor (props) {
            super(props)
            this.state = {
              library,
              filterValue: ''
            }
          }
          filterLibrary (e) {
            this.setState({
              filterValue: e.target.value.trim()
            })
          }
          render () {
            const { library, filterValue } = this.state
            const lowerCaseValue = filterValue.toLowerCase()
            const list = lowerCaseValue === '' ?
              library :
              library.filter( ({keyWords}) => keyWords.some(item => item.toLowerCase().includes(lowerCaseValue)))
            return (
              <div>
                <Filter value={filterValue} onInput={this.filterLibrary.bind(this)}/>
                <ContainWithNotFind list={list} isError={!list.length}/>
              </div>
            )
          }
        }

        const Filter = ({filterValue, onInput}) =>
          <input className="search-input" type="text" value={filterValue} onInput={onInput} />

        const Contain = ({list}) => (
          <ul className="contain">
            { list.map( (item, idx) => <Cell {...item} key={idx}/> ) }
          </ul>
        )

        const ContainWithNotFind = WithError(Contain, 'Ooops! Can not find it here.')

        const Cell = ({ url, imgSrc, title }) => (
          <li className="cell">
            <a href={url} title={title}>
              <div className="img-box">
                <img src={imgSrc} alt={title}/>
              </div>
              <p className="title">{title}</p>
            </a>
          </li>
        )

        ReactDOM.render(
          <App/>,
          document.getElementById('app')
        )
      })(library)
    </script>
</html>